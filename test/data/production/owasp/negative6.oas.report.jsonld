{
  "@context": {
    "actual": {
      "@id": "http://a.ml/vocabularies/validation#actual"
    },
    "argument": {
      "@id": "http://a.ml/vocabularies/validation#argument"
    },
    "column": {
      "@id": "http://a.ml/vocabularies/lexical#column"
    },
    "component": {
      "@id": "http://a.ml/vocabularies/validation#component"
    },
    "condition": {
      "@id": "http://a.ml/vocabularies/validation#condition"
    },
    "conforms": {
      "@id": "http://www.w3.org/ns/shacl#conforms"
    },
    "end": {
      "@id": "http://a.ml/vocabularies/lexical#end"
    },
    "expected": {
      "@id": "http://a.ml/vocabularies/validation#expected"
    },
    "focusNode": {
      "@id": "http://www.w3.org/ns/shacl#focusNode"
    },
    "lexical": "http://a.ml/vocabularies/lexical#",
    "line": {
      "@id": "http://a.ml/vocabularies/lexical#line"
    },
    "location": {
      "@id": "http://a.ml/vocabularies/validation#location"
    },
    "negated": {
      "@id": "http://a.ml/vocabularies/validation#negated"
    },
    "range": {
      "@id": "http://a.ml/vocabularies/lexical#range"
    },
    "result": {
      "@id": "http://www.w3.org/ns/shacl#result"
    },
    "resultMessage": {
      "@id": "http://www.w3.org/ns/shacl#resultMessage"
    },
    "resultPath": {
      "@id": "http://www.w3.org/ns/shacl#resultPath"
    },
    "resultSeverity": {
      "@id": "http://www.w3.org/ns/shacl#resultSeverity"
    },
    "shacl": "http://www.w3.org/ns/shacl#",
    "sourceShapeName": {
      "@id": "http://a.ml/vocabularies/validation#sourceShapeName"
    },
    "start": {
      "@id": "http://a.ml/vocabularies/lexical#start"
    },
    "subResult": {
      "@id": "http://a.ml/vocabularies/validation#subResult"
    },
    "trace": {
      "@id": "http://a.ml/vocabularies/validation#trace"
    },
    "traceValue": {
      "@id": "http://www.w3.org/ns/shacl#traceValue"
    },
    "uri": {
      "@id": "http://a.ml/vocabularies/lexical#uri"
    },
    "validation": "http://a.ml/vocabularies/validation#"
  },
  "@type": "shacl:ValidationReport",
  "conforms": false,
  "result": [
    {
      "@type": [
        "shacl:ValidationResult"
      ],
      "sourceShapeName": "improper-assets-management-environment-info",
      "focusNode": {
        "@id": "file://./test/data/production/owasp/negative6.oas#/web-api"
      },
      "resultSeverity": {
        "@id": "http://www.w3.org/ns/shacl#Violation"
      },
      "resultMessage": "The purpose of an API host is unclear, and there are no explicit answers to the following questions:\n    Which environment is the API running in (e.g., production, staging, test, development)?\n    Who should have network access to the API (e.g., public, internal, partners)?\n",
      "trace": [
        {
          "@type": [
            "validation:TraceMessage"
          ],
          "component": "minCount",
          "resultPath": "apiContract.server",
          "traceValue": {
            "@type": [
              "validation:TraceValue"
            ],
            "actual": 0,
            "condition": ">=",
            "expected": 1,
            "negated": false
          }
        }
      ]
    },
    {
      "@type": [
        "shacl:ValidationResult"
      ],
      "sourceShapeName": "broken-user-authentication-use-tls",
      "focusNode": {
        "@id": "file://./test/data/production/owasp/negative6.oas#/web-api"
      },
      "resultSeverity": {
        "@id": "http://www.w3.org/ns/shacl#Violation"
      },
      "resultMessage": "The login page and all subsequent authenticated pages must be exclusively accessed over TLS or other strong\ntransport. The initial login page referred to as the 'login landing page', must be served over TLS or other strong\ntransport. Failure to utilize TLS or other strong transport for the login landing page allows an attacker to\nmodify the login form action, causing the user's credentials to be posted to an arbitrary location. Failure to\nutilize TLS or other strong transport for authenticated pages after login enables an attacker to view the\nunencrypted session ID and compromise the user's authenticated session.\n",
      "trace": [
        {
          "@type": [
            "validation:TraceMessage"
          ],
          "component": "existential",
          "resultPath": "apiContract.server",
          "traceValue": {
            "@type": [
              "validation:TraceValue"
            ],
            "actual": 0,
            "expected": 0,
            "negated": false,
            "subResult": null
          }
        }
      ]
    },
    {
      "@type": [
        "shacl:ValidationResult"
      ],
      "sourceShapeName": "broken-user-authentication-authenticate-api",
      "focusNode": {
        "@id": "file://./test/data/production/owasp/negative6.oas#/web-api"
      },
      "resultSeverity": {
        "@id": "http://www.w3.org/ns/shacl#Violation"
      },
      "resultMessage": "Make sure you know all the possible flows to authenticate to the API (mobile/ web/deep links that implement\none-click authentication/etc.)\n",
      "trace": [
        {
          "@type": [
            "validation:TraceMessage"
          ],
          "component": "minCount",
          "resultPath": "security.security",
          "traceValue": {
            "@type": [
              "validation:TraceValue"
            ],
            "actual": 0,
            "condition": ">=",
            "expected": 1,
            "negated": false
          }
        },
        {
          "@type": [
            "validation:TraceMessage"
          ],
          "component": "nested",
          "resultPath": "apiContract.endpoint / apiContract.supportedOperation",
          "traceValue": {
            "@type": [
              "validation:TraceValue"
            ],
            "actual": 1,
            "expected": 0,
            "negated": false,
            "subResult": [
              {
                "@type": [
                  "shacl:ValidationResult"
                ],
                "sourceShapeName": "nested",
                "focusNode": {
                  "@id": "file://./test/data/production/owasp/negative6.oas#/web-api/end-points/%2Finvoices%2F/get"
                },
                "resultMessage": "error in nested nodes under apiContract.endpoint / apiContract.supportedOperation",
                "trace": [
                  {
                    "@type": [
                      "validation:TraceMessage"
                    ],
                    "component": "minCount",
                    "resultPath": "security.security",
                    "traceValue": {
                      "@type": [
                        "validation:TraceValue"
                      ],
                      "actual": 0,
                      "condition": ">=",
                      "expected": 1,
                      "negated": false
                    }
                  }
                ]
              }
            ]
          }
        }
      ]
    }
  ]
}
